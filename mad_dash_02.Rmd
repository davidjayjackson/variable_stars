---
title: "Betelgeuse: Varable Star Validation Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    runtime: shiny
    
    # params:
    #   select_star:
    #     label: "Select Star"
    #     value: distinct(star_name)
    #     input: selectInput
    #     sep: ""
    # 
---

```{r global, include=FALSE}
library(flexdashboard)
library(rsconnect)
library(tidyverse)
library(insol)
library(plotly)
library(data.table)
library(lubridate)
library(DT)

rm(list=ls())
mydata <- fread("./star-data.csv")
mydata <- janitor::clean_names(mydata)
mydata$star_name <- toupper(mydata$star_name)
mydata$Ymd <- JD(mydata$jd,inverse = TRUE)
mydata$Ymd <- as.Date(mydata$Ymd)
mydata$Year <- year(mydata$Ymd)
mydata$Month <- month(mydata$Ymd)
mydata <- mydata %>% select(star_name,Ymd,Year,Month,band,magnitude)
mydata$magnitude <- as.numeric( gsub("<","", mydata$magnitude) ) + 0.1
my_year <- mydata %>% distinct(Year)
my_band <- mydata %>% distinct(band)
my_star <- mydata %>% distinct(star_name)

```
## Column {data-width=250}


### 
```{r text-imput}

 selectInput(inputId ="DropDownStar",label="Please Enter Star Name",
              choices =my_star$star_name)
# valueBox(my_star$star_name)
# textInput(inputId = "TextSAmple",label="Star Name")
          
```

### 

```{r Imput Band}
# textInput(inputId = "TextBand",label="Enter Band")
selectInput(inputId ="DropDownBand",label="Please make Selection",
              choices =my_band$band)
```

### 
```{r}
# textInput(inputId = "TextYear",label="Enter Year")
selectInput(inputId ="DropDownYear",label="Select a  Year",
              choices =my_year$Year)
```
```{r}
 alf_ori <- mydata %>% filter(Year =="2019" & band=="Vis." & star_name=="R AQL") 
```
## Column {data-width=750}


### Histogram of Magnitudes

```{r}

 alf_ori %>% plot_ly() %>% add_histogram(x=~magnitude) %>%
    layout(title = "R AQL 2019: Histogram")

```

### Yearly Box Plots of Magnitudes

```{r}
alf_ori %>% plot_ly() %>% add_boxplot(x=~Month,y=~magnitude) %>%
  layout(title = "R AQL 2019: Monthly Boxplots") %>% layout(yaxis = list(autorange = "reversed"))
```


